swagger: "2.0"
info:
  title: Outlook Events Connector
  version: "1.0"

host: graph.microsoft.com
basePath: /v1.0
schemes:
  - https

securityDefinitions:
  oauth2:
    type: oauth2
    flow: accessCode
    authorizationUrl: https://login.microsoftonline.com/common/oauth2/v2.0/authorize
    tokenUrl: https://login.microsoftonline.com/common/oauth2/v2.0/token
    scopes:
      https://graph.microsoft.com/.default: Graph

security:
  - oauth2:
      - https://graph.microsoft.com/.default

paths:
  /me/calendars:
    get:
      operationId: ListCalendars
      responses:
        200:
          description: OK
          schema:
            type: object
            properties:
              value:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                    name:
                      type: string

  /me/calendars/{calendarId}/events:
    post:
      operationId: CreateEvent
      parameters:
        - name: calendarId
          in: path
          required: true
          type: string
          x-ms-dynamic-values:
            operationId: ListCalendars
            value-path: value
            value-title: name

        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              subject:
                type: string
              start:
                type: object
                properties:
                  dateTime:
                    type: string
                  timeZone:
                    type: string
              end:
                type: object
                properties:
                  dateTime:
                    type: string
                  timeZone:
                    type: string

      responses:
        201:
          description: Created
